{"version":3,"file":"export-modal.element-B3lLUUkc.js","sources":["../../../Client/src/services/metrics-export.service.ts","../../../Client/src/components/quick-export-buttons.element.ts","../../../Client/src/components/export-options.element.ts","../../../Client/src/components/export-progress.element.ts","../../../Client/src/components/export-modal.element.ts"],"sourcesContent":["import { ExportOptions } from '../types/export-options.js';\r\n\r\nexport class MetricsExportService {\r\n  private readonly API_BASE_URL = '/umbraco/management/api/v1/metrics';\r\n\r\n  constructor(private tokenProvider: () => Promise<string>) {}\r\n\r\n  /**\r\n   * Export metrics with custom options\r\n   */\r\n  async exportMetrics(options: ExportOptions): Promise<void> {\r\n    const token = await this.tokenProvider();\r\n    \r\n    if (!token) {\r\n      throw new Error('No authentication token available');\r\n    }\r\n\r\n    const response = await fetch(`${this.API_BASE_URL}/export`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': `Bearer ${token}`,\r\n      },\r\n      body: JSON.stringify(options),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      if (response.status === 400) {\r\n        const error = await response.json();\r\n        throw new Error(error.detail || 'Invalid export configuration');\r\n      }\r\n      \r\n      throw new Error(\r\n        `Failed to export metrics: ${response.status} ${response.statusText}`\r\n      );\r\n    }\r\n\r\n    // Trigger file download\r\n    await this.downloadFile(response);\r\n  }\r\n\r\n  /**\r\n   * Export performance metrics only\r\n   */\r\n  async exportPerformanceMetrics(format: string = 'json'): Promise<void> {\r\n    const token = await this.tokenProvider();\r\n    \r\n    const response = await fetch(\r\n      `${this.API_BASE_URL}/export/performance?format=${format}`,\r\n      {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n        },\r\n      }\r\n    );\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to export performance metrics: ${response.statusText}`);\r\n    }\r\n\r\n    await this.downloadFile(response);\r\n  }\r\n\r\n  /**\r\n   * Export Umbraco metrics only\r\n   */\r\n  async exportUmbracoMetrics(format: string='json'): Promise<void> {\r\n    const token = await this.tokenProvider();\r\n    \r\n    const response = await fetch(\r\n      `${this.API_BASE_URL}/export/umbraco?format=${format}`,\r\n      {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n        },\r\n      }\r\n    );\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to export Umbraco metrics: ${response.statusText}`);\r\n    }\r\n\r\n    await this.downloadFile(response);\r\n  }\r\n\r\n  /**\r\n   * Quick export with default options\r\n   */\r\n  async quickExport(\r\n    includePerformance: boolean = true,\r\n    includeUmbraco: boolean = true,\r\n    format: string ='csv'\r\n  ): Promise<void> {\r\n    const options: ExportOptions = {\r\n      format,\r\n      scope: 'current',\r\n      includePerformanceMetrics: includePerformance,\r\n      includeUmbracoMetrics: includeUmbraco,\r\n      includeActiveRequests: false,\r\n      timezone: 'UTC'\r\n    };\r\n\r\n    await this.exportMetrics(options);\r\n  }\r\n\r\n  /**\r\n   * Download file from response\r\n   */\r\n  private async downloadFile(response: Response): Promise<void> {\r\n    // Get filename from Content-Disposition header or generate one\r\n    const contentDisposition = response.headers.get('Content-Disposition');\r\n    let filename = 'metrics-export';\r\n    \r\n    if (contentDisposition) {\r\n      const filenameMatch = contentDisposition.match(/filename=\"?([^\"]+)\"?/);\r\n      if (filenameMatch && filenameMatch[1]) {\r\n        filename = filenameMatch[1];\r\n      }\r\n    }\r\n\r\n    // Get blob and create download link\r\n    const blob = await response.blob();\r\n    const url = window.URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n  a.target = '_blank';\r\n    a.download = filename;\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    \r\n    // Cleanup\r\n    window.URL.revokeObjectURL(url);\r\n    document.body.removeChild(a);\r\n  }\r\n\r\n  /**\r\n   * Get file size estimate for export\r\n   */\r\n  estimateFileSize(options: ExportOptions): string {\r\n    // Simple estimation based on format and included metrics\r\n    let estimatedSize = 0;\r\n    \r\n    // Base size for current snapshot\r\n    if (options.includePerformanceMetrics) estimatedSize += 5; // ~5KB for performance metrics\r\n    if (options.includeUmbracoMetrics) estimatedSize += 3; // ~3KB for Umbraco metrics\r\n    if (options.includeActiveRequests) estimatedSize += 2; // ~2KB for active requests\r\n    \r\n    // Adjust for historical data\r\n    if (options.scope === 'historical' || options.scope === 'custom') {\r\n      // Historical data is much larger - estimate based on number of records\r\n      // Assume ~1KB per performance metric record for historical data\r\n      if (options.includePerformanceMetrics) {\r\n        // For historical scope, estimate last 30 days with 5-second intervals\r\n        if (options.scope === 'historical') {\r\n          estimatedSize += 30 * 24 * 60 * 60 / 5 * 1; // 30 days * 24 hours * 60 minutes * 60 seconds / 5 second intervals * 1KB\r\n        } else if (options.scope === 'custom' && options.startDate && options.endDate) {\r\n          // For custom scope, estimate based on date range\r\n          const start = new Date(options.startDate);\r\n          const end = new Date(options.endDate);\r\n          const days = Math.max(1, Math.ceil((end.getTime() - start.getTime()) / (1000 * 60 * 60 * 24)));\r\n          estimatedSize += days * 24 * 60 * 60 / 5 * 1; // days * 24 hours * 60 minutes * 60 seconds / 5 second intervals * 1KB\r\n        }\r\n      }\r\n      \r\n      // Note: Historical Umbraco metrics not implemented yet\r\n      if (options.includeUmbracoMetrics) {\r\n        estimatedSize += 0; // No historical Umbraco metrics storage yet\r\n      }\r\n    }\r\n    \r\n    // Format multipliers\r\n    switch (options.format) {\r\n      case 'json':\r\n        estimatedSize *= 1.2; // JSON is slightly larger\r\n        break;\r\n      case 'csv':\r\n        estimatedSize *= 0.8; // CSV is more compact\r\n        break;\r\n      case 'xml':\r\n        estimatedSize *= 1.5; // XML has more markup\r\n        break;\r\n    }\r\n    \r\n    if (estimatedSize < 1) {\r\n      return '< 1 KB';\r\n    } else if (estimatedSize < 1024) {\r\n      return `${Math.round(estimatedSize)} KB`;\r\n    } else if (estimatedSize < 1024 * 1024) {\r\n      return `${(estimatedSize / 1024).toFixed(1)} MB`;\r\n    } else {\r\n      return `${(estimatedSize / (1024 * 1024)).toFixed(1)} GB`;\r\n    }\r\n  }\r\n\r\n\r\n\r\n}","import {\r\n  LitElement,\r\n  css,\r\n  html,\r\n  customElement,\r\n  property,\r\n} from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\r\n\r\n@customElement(\"umbmetrics-quick-export-buttons\")\r\nexport class QuickExportButtonsElement extends UmbElementMixin(LitElement) {\r\n  @property({ type: Boolean })\r\n  disabled: boolean = false;\r\n\r\n  @property({ type: Function })\r\n  onCsvExport?: () => void;\r\n\r\n  @property({ type: Function })\r\n  onJsonExport?: () => void;\r\n\r\n  render() {\r\n    return html`\r\n      <div class=\"quick-export-section\">\r\n        <h4>${this.localize?.term('export_quickExport') || 'Quick Export'}</h4>\r\n        <p class=\"description\">${this.localize?.term('export_quickExportDescription') || 'Export all metrics with one click'}</p>\r\n        \r\n        <div class=\"quick-export-buttons\">\r\n          <uui-button \r\n            look=\"primary\" \r\n            color=\"positive\"\r\n            @click=\"${this.#handleCsvExport}\"\r\n            ?disabled=\"${this.disabled}\"\r\n          >\r\n            <uui-icon name=\"icon-download\"></uui-icon>\r\n            ${this.localize?.term('export_exportAsCsv') || 'Export as CSV'}\r\n          </uui-button>\r\n          \r\n          <uui-button \r\n            look=\"outline\"\r\n            @click=\"${this.#handleJsonExport}\"\r\n            ?disabled=\"${this.disabled}\"\r\n          >\r\n            <uui-icon name=\"icon-download\"></uui-icon>\r\n            ${this.localize?.term('export_exportAsJson') || 'Export as JSON'}\r\n          </uui-button>\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  #handleCsvExport = () => {\r\n    if (this.onCsvExport) {\r\n      this.onCsvExport();\r\n    }\r\n  };\r\n\r\n  #handleJsonExport = () => {\r\n    if (this.onJsonExport) {\r\n      this.onJsonExport();\r\n    }\r\n  };\r\n\r\n  static styles = css`\r\n    .quick-export-section {\r\n      margin-bottom: var(--uui-size-space-5);\r\n    }\r\n\r\n    h4 {\r\n      margin: 0 0 var(--uui-size-space-2) 0;\r\n      font-size: 1.25rem;\r\n      font-weight: 600;\r\n      color: var(--uui-color-text);\r\n    }\r\n\r\n    .description {\r\n      margin: 0 0 var(--uui-size-space-4) 0;\r\n      color: var(--uui-color-text-alt);\r\n      font-size: 0.875rem;\r\n    }\r\n\r\n    .quick-export-buttons {\r\n      display: flex;\r\n      gap: var(--uui-size-space-3);\r\n      flex-wrap: wrap;\r\n    }\r\n\r\n    @media (max-width: 600px) {\r\n      .quick-export-buttons {\r\n        flex-direction: column;\r\n      }\r\n    }\r\n  `;\r\n}\r\n\r\nexport default QuickExportButtonsElement;\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    \"umbmetrics-quick-export-buttons\": QuickExportButtonsElement;\r\n  }\r\n}","import {\r\n  LitElement,\r\n  css,\r\n  unsafeCSS,\r\n  html,\r\n  customElement,\r\n  property,\r\n} from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\r\nimport {   ExportOptions } from \"../types/export-options.js\";\r\nimport styles from '../css/export-options.styles.css?inline';\r\n\r\n@customElement(\"umbmetrics-export-options\")\r\nexport class ExportOptionsElement extends UmbElementMixin(LitElement) {\r\n  @property({ type: Object })\r\n  exportOptions: ExportOptions = {\r\n    format: 'csv',\r\n    scope: 'current',\r\n    includePerformanceMetrics: true,\r\n    includeUmbracoMetrics: true,\r\n    includeActiveRequests: false,\r\n    timezone: 'UTC'\r\n  };\r\n\r\n  @property({ type: Boolean })\r\n  disabled: boolean = false;\r\n\r\n  @property({ type: String })\r\n  estimatedSize: string = '';\r\n\r\n\r\n  formatOptions: Array<Option> = [\r\n { value: 'csv', name: this.localize?.term('formats_csv') || 'CSV' },\r\n { value: 'json', name: this.localize?.term('formats_json') || 'JSON' },\r\n{ value: 'xml', name: this.localize?.term('formats_xml') || 'XML' }\r\n  ];\r\n\r\n\r\n  scopeOptions: Array<Option> = [{ value: 'current', name: this.localize?.term('exportOptions_currentSnapshot') || 'Current Snapshot' },\r\n    { value: 'historical', name: this.localize?.term('exportOptions_historicalData') || 'Historical Data' },\r\n    { value: 'custom', name: this.localize?.term('exportOptions_customRange') || 'Custom Range'}];\r\n\r\n  @property({ type: Function })\r\n  onFormatChange?: (format: string) => void;\r\n\r\n  @property({ type: Function })\r\n  onScopeChange?: (scope: string) => void;\r\n\r\n  @property({ type: Function })\r\n  onMetricToggle?: (metric: keyof ExportOptions) => void;\r\n\r\n  @property({ type: Function })\r\n  onDateChange?: (dateField: 'startDate' | 'endDate', value: string) => void;\r\n\r\n  @property({ type: Function })\r\n  onTimezoneChange?: (timezone: string) => void;\r\n\r\n  #handleFormatChange = (e: Event) => {\r\n    const select = e.target as HTMLSelectElement;\r\n    if (this.onFormatChange) {\r\n      this.onFormatChange(select.value as string);\r\n    }\r\n  };\r\n\r\n  #handleScopeChange = (e: Event) => {\r\n    const select = e.target as HTMLSelectElement;\r\n    if (this.onScopeChange) {\r\n      this.onScopeChange(select.value as string);\r\n    }\r\n  };\r\n\r\n  #handleMetricToggle = (metric: keyof ExportOptions) => {\r\n    if (this.onMetricToggle) {\r\n      this.onMetricToggle(metric);\r\n    }\r\n  };\r\n\r\n  #handleDateChange = (dateField: 'startDate' | 'endDate', e: Event) => {\r\n    const input = e.target as HTMLInputElement;\r\n    if (this.onDateChange) {\r\n      this.onDateChange(dateField, input.value);\r\n    }\r\n  };\r\n\r\n  #handleTimezoneChange = (e: Event) => {\r\n    const select = e.target as HTMLSelectElement;\r\n    if (this.onTimezoneChange) {\r\n      this.onTimezoneChange(select.value);\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return html`\r\n      <div class=\"export-options-section\">\r\n        <h4>${this.localize?.term('export_customExport') || 'Custom Export'}</h4>\r\n        <p class=\"description\">${this.localize?.term('export_customExportDescription') || 'Configure export options'}</p>\r\n        \r\n        <div class=\"form-grid\">\r\n          <!-- Format Selection -->\r\n          <div class=\"form-group\">\r\n            <label for=\"export-format\">${this.localize?.term('exportOptions_format') || 'Format'}</label>\r\n            <uui-select \r\n              id=\"export-format\"\r\n              .value=\"${this.exportOptions.format}\"\r\n              @change=\"${this.#handleFormatChange}\"\r\n              ?disabled=\"${this.disabled}\"\r\n              .options=\"${this.formatOptions}\"\r\n            >           \r\n            </uui-select>\r\n          </div>\r\n\r\n          <!-- Scope Selection -->\r\n          <div class=\"form-group\">\r\n            <label for=\"export-scope\">${this.localize?.term('exportOptions_scope') || 'Scope'}</label>\r\n            <uui-select \r\n              id=\"export-scope\"\r\n              .value=\"${this.exportOptions.scope}\"\r\n              @change=\"${this.#handleScopeChange}\"\r\n              ?disabled=\"${this.disabled}\"\r\n            >            \r\n            </uui-select>\r\n          </div>\r\n\r\n          <!-- Date Range (only for custom scope) -->\r\n          ${this.exportOptions.scope === 'custom' ? html`\r\n            <div class=\"form-group span-2\">\r\n              <label>${this.localize?.term('exportOptions_dateRange') || 'Date Range'}</label>\r\n              <div class=\"date-range\">\r\n                <uui-input\r\n                  type=\"date\"\r\n                  label=\"${this.localize?.term('exportOptions_startDate') || 'Start Date'}\"\r\n                  .value=\"${this.exportOptions.startDate || ''}\"\r\n                  @change=\"${(e: Event) => this.#handleDateChange('startDate', e)}\"\r\n                  ?disabled=\"${this.disabled}\"\r\n                ></uui-input>\r\n                \r\n                <span class=\"date-separator\">${this.localize?.term('exportOptions_to') || 'to'}</span>\r\n                \r\n                <uui-input\r\n                  type=\"date\"\r\n                  label=\"${this.localize?.term('exportOptions_endDate') || 'End Date'}\"\r\n                  .value=\"${this.exportOptions.endDate || ''}\"\r\n                  @change=\"${(e: Event) => this.#handleDateChange('endDate', e)}\"\r\n                  ?disabled=\"${this.disabled}\"\r\n                ></uui-input>\r\n              </div>\r\n            </div>\r\n          ` : ''}\r\n\r\n          <!-- Timezone -->\r\n          <div class=\"form-group\">\r\n            <label for=\"export-timezone\">${this.localize?.term('exportOptions_timezone') || 'Timezone'}</label>\r\n            <uui-select \r\n              id=\"export-timezone\"\r\n              .value=\"${this.exportOptions.timezone}\"\r\n              @change=\"${this.#handleTimezoneChange}\"\r\n              ?disabled=\"${this.disabled}\"\r\n            >\r\n              <uui-option value=\"UTC\">${this.localize?.term('timezones_utc') || 'UTC'}</uui-option>\r\n              <uui-option value=\"Local\">${this.localize?.term('timezones_local') || 'Local Time'}</uui-option>\r\n              <uui-option value=\"Europe/London\">${this.localize?.term('timezones_europeLondon') || 'Europe/London'}</uui-option>\r\n              <uui-option value=\"America/New_York\">${this.localize?.term('timezones_americaNewYork') || 'America/New_York'}</uui-option>\r\n              <uui-option value=\"Asia/Tokyo\">${this.localize?.term('timezones_asiaTokyo') || 'Asia/Tokyo'}</uui-option>\r\n            </uui-select>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Metric Selection -->\r\n        <div class=\"metric-selection\">\r\n          <h5>${this.localize?.term('exportOptions_includeMetrics') || 'Include Metrics'}</h5>\r\n          <div class=\"metric-toggles\">\r\n            <uui-toggle \r\n              label=\"${this.localize?.term('exportOptions_performanceMetrics') || 'Performance Metrics'}\"\r\n              .checked=\"${this.exportOptions.includePerformanceMetrics}\"\r\n              @change=\"${() => this.#handleMetricToggle('includePerformanceMetrics')}\"\r\n              ?disabled=\"${this.disabled}\"\r\n            ></uui-toggle>\r\n            \r\n            <uui-toggle \r\n              label=\"${this.localize?.term('exportOptions_umbracoMetrics') || 'Umbraco Metrics'}\"\r\n              .checked=\"${this.exportOptions.includeUmbracoMetrics}\"\r\n              @change=\"${() => this.#handleMetricToggle('includeUmbracoMetrics')}\"\r\n              ?disabled=\"${this.disabled}\"\r\n            ></uui-toggle>\r\n            \r\n            <uui-toggle \r\n              label=\"${this.localize?.term('exportOptions_activeRequests') || 'Active Requests'}\"\r\n              .checked=\"${this.exportOptions.includeActiveRequests}\"\r\n              @change=\"${() => this.#handleMetricToggle('includeActiveRequests')}\"\r\n              ?disabled=\"${this.disabled}\"\r\n            ></uui-toggle>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Estimated Size -->\r\n        <div class=\"estimated-size\">\r\n          <uui-icon name=\"icon-info\"></uui-icon>\r\n          ${this.localize?.term('export_estimatedFileSize') || 'Estimated file size'}: <strong>${this.estimatedSize}</strong>\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  static styles = css`${unsafeCSS(styles)}`;\r\n}\r\n\r\nexport default ExportOptionsElement;\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    \"umbmetrics-export-options\": ExportOptionsElement;\r\n  }\r\n}","import {\r\n  LitElement,\r\n  css,\r\n  unsafeCSS,\r\n  html,\r\n  customElement,\r\n  property,\r\n} from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\r\nimport styles from '../css/export-progress.styles.css?inline';\r\n\r\n@customElement(\"umbmetrics-export-progress\")\r\nexport class ExportProgressElement extends UmbElementMixin(LitElement) {\r\n  @property({ type: Boolean })\r\n  isExporting: boolean = false;\r\n\r\n  @property({ type: Number })\r\n  progress: number = 0;\r\n\r\n  render() {\r\n    if (!this.isExporting) {\r\n      return html``;\r\n    }\r\n\r\n    return html`\r\n      <div class=\"export-progress\">\r\n        <div class=\"progress-bar\">\r\n          <div class=\"progress-fill\" style=\"width: ${this.progress}%\"></div>\r\n        </div>\r\n        <div class=\"progress-text\">\r\n          ${this.localize?.term('export_exporting') || 'Exporting...'} ${this.progress}%\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  static styles = css`${unsafeCSS(styles)}`;\r\n}\r\n\r\nexport default ExportProgressElement;\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    \"umbmetrics-export-progress\": ExportProgressElement;\r\n  }\r\n}","import {\r\n  css,\r\n  unsafeCSS,\r\n  html,\r\n  customElement,\r\n  state,\r\n} from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\r\nimport { UmbModalElement } from \"@umbraco-cms/backoffice/modal\";\r\nimport { UMB_NOTIFICATION_CONTEXT } from \"@umbraco-cms/backoffice/notification\";\r\nimport { UMB_AUTH_CONTEXT } from \"@umbraco-cms/backoffice/auth\";\r\nimport { MetricsExportService } from \"../services/metrics-export.service.js\";\r\nimport {   ExportOptions } from \"../types/export-options.js\";\r\nimport { UUIModalElement } from \"@umbraco-cms/backoffice/external/uui\";\r\nimport stylesString from '../css/export-modal.styles.css?inline';\r\n\r\n// Import child components\r\nimport './quick-export-buttons.element.js';\r\nimport './export-options.element.js';\r\nimport './export-progress.element.js';\r\n\r\n@customElement(\"umbmetrics-export-modal\")\r\nexport class UmbMetricsExportModalElement extends UmbElementMixin(UmbModalElement) {\r\n  modalContext: any;\r\n\r\n  @state()\r\n  private _isExporting: boolean = false;\r\n\r\n  @state()\r\n  private _exportProgress: number = 0;\r\n\r\n  @state()\r\n  private _exportOptions: ExportOptions = {\r\n    format: \"csv\",\r\n    scope: 'current',\r\n    includePerformanceMetrics: true,\r\n    includeUmbracoMetrics: true,\r\n    includeActiveRequests: false,\r\n    timezone: 'UTC'\r\n  };\r\n\r\n  @state()\r\n  private _estimatedSize: string = '';\r\n\r\n  #exportService?: MetricsExportService;\r\n  #notificationContext?: typeof UMB_NOTIFICATION_CONTEXT.TYPE;\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    this.consumeContext(UMB_NOTIFICATION_CONTEXT, (notificationContext) => {\r\n      this.#notificationContext = notificationContext;\r\n    });\r\n\r\n    this.consumeContext(UMB_AUTH_CONTEXT, (authContext) => {\r\n      this.#exportService = new MetricsExportService(async () => {\r\n        const token = await authContext?.getLatestToken();\r\n        if (!token) {\r\n          throw new Error('No authentication token available');\r\n        }\r\n        return token;\r\n      });\r\n    });\r\n\r\n    // Calculate initial estimated size\r\n    this.#updateEstimatedSize();\r\n  }\r\n\r\n  #updateEstimatedSize() {\r\n    if (this.#exportService) {\r\n      this._estimatedSize = this.#exportService.estimateFileSize(this._exportOptions);\r\n    }\r\n  }\r\n\r\n  #handleExport = async () => {\r\n    if (!this.#exportService || this._isExporting) {\r\n      return;\r\n    }\r\n\r\n    this._isExporting = true;\r\n    this._exportProgress = 10;\r\n\r\n    try {\r\n      // Validate date range if custom scope\r\n      if (this._exportOptions.scope === 'custom') {\r\n        if (!this._exportOptions.startDate || !this._exportOptions.endDate) {\r\n          throw new Error(this.localize?.term('validation_bothDatesRequired') || 'Both start and end dates are required for custom range');\r\n        }\r\n        \r\n        const start = new Date(this._exportOptions.startDate);\r\n        const end = new Date(this._exportOptions.endDate);\r\n        \r\n        if (start > end) {\r\n          throw new Error(this.localize?.term('validation_startDateBeforeEndDate') || 'Start date must be before end date');\r\n        }\r\n      }\r\n\r\n      this._exportProgress = 30;\r\n      \r\n      await this.#exportService.exportMetrics(this._exportOptions);\r\n      \r\n      this._exportProgress = 100;\r\n      \r\n      if (this.#notificationContext) {\r\n        this.#notificationContext.peek(\"positive\", {\r\n          data: {\r\n            headline: this.localize?.term('export_exportComplete') || 'Export Complete',\r\n            message: `${this.localize?.term('export_metricsExportedSuccessfully') || 'Metrics exported successfully'} (${this._estimatedSize})`,\r\n          },\r\n        });\r\n      }\r\n\r\n      // Close modal after short delay\r\n      setTimeout(() => {\r\n        if (this.modalContext) {\r\n          this.modalContext.submit();\r\n        }\r\n      }, 1000);\r\n\r\n    } catch (error) {\r\n      console.error('Export error:', error);\r\n      \r\n      if (this.#notificationContext) {\r\n        this.#notificationContext.peek(\"danger\", {\r\n          data: {\r\n            headline: this.localize?.term('export_exportFailed') || 'Export Failed',\r\n            message: error instanceof Error \r\n              ? error.message \r\n              : this.localize?.term('export_failedToExportMetrics') || 'Failed to export metrics. Please try again.',\r\n          },\r\n        });\r\n      }\r\n      \r\n      this._isExporting = false;\r\n      this._exportProgress = 0;\r\n    }\r\n  };\r\n\r\n  #handleQuickExport = async (format: string) => {\r\n    if (!this.#exportService || this._isExporting) {\r\n      return;\r\n    }\r\n\r\n    this._isExporting = true;\r\n\r\n    try {\r\n      await this.#exportService.quickExport(true, true, format);\r\n      \r\n      if (this.#notificationContext) {\r\n        this.#notificationContext.peek(\"positive\", {\r\n          data: {\r\n            headline: this.localize?.term('export_exportComplete') || 'Export Complete',\r\n            message: `${this.localize?.term('export_quickExportCompleted') || 'Quick export to'} ${format.toUpperCase()} ${this.localize?.term('export_completed') || 'completed'}`,\r\n          },\r\n        });\r\n      }\r\n\r\n      // Close modal\r\n      if (this.modalContext) {\r\n        this.modalContext.submit();\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('Quick export error:', error);\r\n      \r\n      if (this.#notificationContext) {\r\n        this.#notificationContext.peek(\"danger\", {\r\n          data: {\r\n            headline: this.localize?.term('export_exportFailed') || 'Export Failed',\r\n            message: error instanceof Error \r\n              ? error.message \r\n              : this.localize?.term('export_failedToExportMetrics') || 'Failed to export metrics',\r\n          },\r\n        });\r\n      }\r\n    } finally {\r\n      this._isExporting = false;\r\n    }\r\n  };\r\n\r\n  #handleCancel = () => {\r\n    if (this.modalContext) {\r\n      this.modalContext.reject();\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return html`\r\n      <umb-modal-sidebar>\r\n        <umb-body-layout headline=\"${this.localize?.term('export_title') || 'Export Metrics'}\">\r\n          <div id=\"main\">\r\n            <umbmetrics-quick-export-buttons\r\n              ?disabled=\"${this._isExporting}\"\r\n              .onCsvExport=\"${() => this.#handleQuickExport('csv')}\"\r\n              .onJsonExport=\"${() => this.#handleQuickExport('csv')}\"\r\n            ></umbmetrics-quick-export-buttons>\r\n            \r\n            <div class=\"divider\">\r\n              <span>${this.localize?.term('common_or') || 'or'}</span>\r\n            </div>\r\n            \r\n            <umbmetrics-export-options\r\n              .exportOptions=\"${this._exportOptions}\"\r\n              ?disabled=\"${this._isExporting}\"\r\n              .estimatedSize=\"${this._estimatedSize}\"     \r\n              .onFormatChange=\"${(format: string) => {\r\n                this._exportOptions = { ...this._exportOptions, format };\r\n                this.#updateEstimatedSize();\r\n              }}\"\r\n              .onScopeChange=\"${(scope: string) => {\r\n                this._exportOptions = { ...this._exportOptions, scope };\r\n              }}\"\r\n              .onMetricToggle=\"${(metric: keyof ExportOptions) => {\r\n                this._exportOptions = {\r\n                  ...this._exportOptions,\r\n                  [metric]: !this._exportOptions[metric]\r\n                };\r\n                this.#updateEstimatedSize();\r\n              }}\"\r\n              .onDateChange=\"${(dateField: 'startDate' | 'endDate', value: string) => {\r\n                this._exportOptions = {\r\n                  ...this._exportOptions,\r\n                  [dateField]: value || undefined\r\n                };\r\n              }}\"\r\n              .onTimezoneChange=\"${(timezone: string) => {\r\n                this._exportOptions = { ...this._exportOptions, timezone };\r\n              }}\"\r\n            ></umbmetrics-export-options>\r\n            \r\n            <umbmetrics-export-progress\r\n              .isExporting=\"${this._isExporting}\"\r\n              .progress=\"${this._exportProgress}\"\r\n            ></umbmetrics-export-progress>\r\n          </div>\r\n          \r\n          <div slot=\"actions\">\r\n            <uui-button \r\n              look=\"secondary\"\r\n              @click=\"${this.#handleCancel}\"\r\n              ?disabled=\"${this._isExporting}\"\r\n            >\r\n              ${this.localize?.term('export_cancel') || 'Cancel'}\r\n            </uui-button>\r\n            \r\n            <uui-button \r\n              look=\"primary\"\r\n              color=\"positive\"\r\n              @click=\"${this.#handleExport}\"\r\n              ?disabled=\"${this._isExporting || (!this._exportOptions.includePerformanceMetrics && !this._exportOptions.includeUmbracoMetrics)}\"\r\n            >\r\n              ${this._isExporting ? html`\r\n                <uui-icon name=\"icon-time\"></uui-icon>\r\n                ${this.localize?.term('export_exporting') || 'Exporting...'}\r\n              ` : html`\r\n                <uui-icon name=\"icon-download\"></uui-icon>\r\n                ${this.localize?.term('export_exportMetrics') || 'Export Metrics'}\r\n              `}\r\n            </uui-button>\r\n          </div>\r\n        </umb-body-layout>\r\n      </umb-modal-sidebar>\r\n    `;\r\n  }\r\n\r\n  static styles = [...UUIModalElement.styles, css`${unsafeCSS(stylesString)}`];\r\n}\r\n\r\nexport default UmbMetricsExportModalElement;\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    \"umbmetrics-export-modal\": UmbMetricsExportModalElement;\r\n  }\r\n}\r\n"],"names":["MetricsExportService","tokenProvider","options","token","response","error","format","includePerformance","includeUmbraco","contentDisposition","filename","filenameMatch","blob","url","a","estimatedSize","start","end","days","_handleCsvExport","_handleJsonExport","QuickExportButtonsElement","UmbElementMixin","LitElement","__privateAdd","html","__privateGet","css","__decorateClass","property","customElement","_handleFormatChange","_handleScopeChange","_handleMetricToggle","_handleDateChange","_handleTimezoneChange","ExportOptionsElement","e","select","metric","dateField","input","unsafeCSS","styles","ExportProgressElement","_exportService","_notificationContext","_UmbMetricsExportModalElement_instances","updateEstimatedSize_fn","_handleExport","_handleQuickExport","_handleCancel","UmbMetricsExportModalElement","UmbModalElement","UMB_NOTIFICATION_CONTEXT","notificationContext","__privateSet","UMB_AUTH_CONTEXT","authContext","__privateMethod","scope","value","timezone","UUIModalElement","stylesString","state","UmbMetricsExportModalElement_default"],"mappings":";;;;;;AAEO,MAAMA,GAAqB;AAAA,EAGhC,YAAoBC,GAAsC;AAAtC,SAAA,gBAAAA,GAFpB,KAAiB,eAAe;AAAA,EAE2B;AAAA;AAAA;AAAA;AAAA,EAK3D,MAAM,cAAcC,GAAuC;AACzD,UAAMC,IAAQ,MAAM,KAAK,cAAA;AAEzB,QAAI,CAACA;AACH,YAAM,IAAI,MAAM,mCAAmC;AAGrD,UAAMC,IAAW,MAAM,MAAM,GAAG,KAAK,YAAY,WAAW;AAAA,MAC1D,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,eAAiB,UAAUD,CAAK;AAAA,MAAA;AAAA,MAElC,MAAM,KAAK,UAAUD,CAAO;AAAA,IAAA,CAC7B;AAED,QAAI,CAACE,EAAS,IAAI;AAChB,UAAIA,EAAS,WAAW,KAAK;AAC3B,cAAMC,IAAQ,MAAMD,EAAS,KAAA;AAC7B,cAAM,IAAI,MAAMC,EAAM,UAAU,8BAA8B;AAAA,MAChE;AAEA,YAAM,IAAI;AAAA,QACR,6BAA6BD,EAAS,MAAM,IAAIA,EAAS,UAAU;AAAA,MAAA;AAAA,IAEvE;AAGA,UAAM,KAAK,aAAaA,CAAQ;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,yBAAyBE,IAAiB,QAAuB;AACrE,UAAMH,IAAQ,MAAM,KAAK,cAAA,GAEnBC,IAAW,MAAM;AAAA,MACrB,GAAG,KAAK,YAAY,8BAA8BE,CAAM;AAAA,MACxD;AAAA,QACE,QAAQ;AAAA,QACR,SAAS;AAAA,UACP,eAAiB,UAAUH,CAAK;AAAA,QAAA;AAAA,MAClC;AAAA,IACF;AAGF,QAAI,CAACC,EAAS;AACZ,YAAM,IAAI,MAAM,yCAAyCA,EAAS,UAAU,EAAE;AAGhF,UAAM,KAAK,aAAaA,CAAQ;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAAqBE,IAAe,QAAuB;AAC/D,UAAMH,IAAQ,MAAM,KAAK,cAAA,GAEnBC,IAAW,MAAM;AAAA,MACrB,GAAG,KAAK,YAAY,0BAA0BE,CAAM;AAAA,MACpD;AAAA,QACE,QAAQ;AAAA,QACR,SAAS;AAAA,UACP,eAAiB,UAAUH,CAAK;AAAA,QAAA;AAAA,MAClC;AAAA,IACF;AAGF,QAAI,CAACC,EAAS;AACZ,YAAM,IAAI,MAAM,qCAAqCA,EAAS,UAAU,EAAE;AAG5E,UAAM,KAAK,aAAaA,CAAQ;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YACJG,IAA8B,IAC9BC,IAA0B,IAC1BF,IAAgB,OACD;AACf,UAAMJ,IAAyB;AAAA,MAC7B,QAAAI;AAAA,MACA,OAAO;AAAA,MACP,2BAA2BC;AAAA,MAC3B,uBAAuBC;AAAA,MACvB,uBAAuB;AAAA,MACvB,UAAU;AAAA,IAAA;AAGZ,UAAM,KAAK,cAAcN,CAAO;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,aAAaE,GAAmC;AAE5D,UAAMK,IAAqBL,EAAS,QAAQ,IAAI,qBAAqB;AACrE,QAAIM,IAAW;AAEf,QAAID,GAAoB;AACtB,YAAME,IAAgBF,EAAmB,MAAM,sBAAsB;AACrE,MAAIE,KAAiBA,EAAc,CAAC,MAClCD,IAAWC,EAAc,CAAC;AAAA,IAE9B;AAGA,UAAMC,IAAO,MAAMR,EAAS,KAAA,GACtBS,IAAM,OAAO,IAAI,gBAAgBD,CAAI,GACrCE,IAAI,SAAS,cAAc,GAAG;AACpC,IAAAA,EAAE,OAAOD,GACXC,EAAE,SAAS,UACTA,EAAE,WAAWJ,GACb,SAAS,KAAK,YAAYI,CAAC,GAC3BA,EAAE,MAAA,GAGF,OAAO,IAAI,gBAAgBD,CAAG,GAC9B,SAAS,KAAK,YAAYC,CAAC;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA,EAKA,iBAAiBZ,GAAgC;AAE/C,QAAIa,IAAgB;AAQpB,QALIb,EAAQ,8BAA2Ba,KAAiB,IACpDb,EAAQ,0BAAuBa,KAAiB,IAChDb,EAAQ,0BAAuBa,KAAiB,IAGhDb,EAAQ,UAAU,gBAAgBA,EAAQ,UAAU,UAAU;AAGhE,UAAIA,EAAQ;AAEV,YAAIA,EAAQ,UAAU;AACpB,UAAAa,KAAiB,MAAU,KAAK,KAAK,IAAI;AAAA,iBAChCb,EAAQ,UAAU,YAAYA,EAAQ,aAAaA,EAAQ,SAAS;AAE7E,gBAAMc,IAAQ,IAAI,KAAKd,EAAQ,SAAS,GAClCe,IAAM,IAAI,KAAKf,EAAQ,OAAO,GAC9BgB,IAAO,KAAK,IAAI,GAAG,KAAK,MAAMD,EAAI,QAAA,IAAYD,EAAM,cAAc,MAAO,KAAK,KAAK,GAAG,CAAC;AAC7F,UAAAD,KAAiBG,IAAO,KAAK,KAAK,KAAK,IAAI;AAAA,QAC7C;AAAA;AAIF,MAAIhB,EAAQ,0BACVa,KAAiB;AAAA,IAErB;AAGA,YAAQb,EAAQ,QAAA;AAAA,MACd,KAAK;AACH,QAAAa,KAAiB;AACjB;AAAA,MACF,KAAK;AACH,QAAAA,KAAiB;AACjB;AAAA,MACF,KAAK;AACH,QAAAA,KAAiB;AACjB;AAAA,IAAA;AAGJ,WAAIA,IAAgB,IACX,WACEA,IAAgB,OAClB,GAAG,KAAK,MAAMA,CAAa,CAAC,QAC1BA,IAAgB,OAAO,OACzB,IAAIA,IAAgB,MAAM,QAAQ,CAAC,CAAC,QAEpC,IAAIA,KAAiB,OAAO,OAAO,QAAQ,CAAC,CAAC;AAAA,EAExD;AAIF;;;;;;;;yQCtMAI,GAAAC;AAUO,IAAMC,IAAN,cAAwCC,EAAgBC,CAAU,EAAE;AAAA,EAApE,cAAA;AAAA,UAAA,GAAA,SAAA,GAEL,KAAA,WAAoB,IAsCpBC,EAAA,MAAAL,GAAmB,MAAM;AACvB,MAAI,KAAK,eACP,KAAK,YAAA;AAAA,IAET,CAAA,GAEAK,EAAA,MAAAJ,GAAoB,MAAM;AACxB,MAAI,KAAK,gBACP,KAAK,aAAA;AAAA,IAET,CAAA;AAAA,EAAA;AAAA,EAxCA,SAAS;AACP,WAAOK;AAAA;AAAA,cAEG,KAAK,UAAU,KAAK,oBAAoB,KAAK,cAAc;AAAA,iCACxC,KAAK,UAAU,KAAK,+BAA+B,KAAK,mCAAmC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAMtGC,QAAKP,CAAA,CAAgB;AAAA,yBAClB,KAAK,QAAQ;AAAA;AAAA;AAAA,cAGxB,KAAK,UAAU,KAAK,oBAAoB,KAAK,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA,sBAKpDO,QAAKN,CAAA,CAAiB;AAAA,yBACnB,KAAK,QAAQ;AAAA;AAAA;AAAA,cAGxB,KAAK,UAAU,KAAK,qBAAqB,KAAK,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA,EAK1E;AA4CF;AA1CED,IAAA,oBAAA,QAAA;AAMAC,IAAA,oBAAA,QAAA;AA9CWC,EAoDJ,SAASM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAlDhBC,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,QAAA,CAAS;AAAA,GADhBR,EAEX,WAAA,YAAA,CAAA;AAGAO,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,SAAA,CAAU;AAAA,GAJjBR,EAKX,WAAA,eAAA,CAAA;AAGAO,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,SAAA,CAAU;AAAA,GAPjBR,EAQX,WAAA,gBAAA,CAAA;AARWA,IAANO,EAAA;AAAA,EADNE,EAAc,iCAAiC;AAAA,GACnCT,CAAA;;;;;;;;yQCVbU,GAAAC,GAAAC,GAAAC,GAAAC;AAaO,IAAMC,IAAN,cAAmCd,EAAgBC,CAAU,EAAE;AAAA,EAA/D,cAAA;AAAA,UAAA,GAAA,SAAA,GAEL,KAAA,gBAA+B;AAAA,MAC7B,QAAQ;AAAA,MACR,OAAO;AAAA,MACP,2BAA2B;AAAA,MAC3B,uBAAuB;AAAA,MACvB,uBAAuB;AAAA,MACvB,UAAU;AAAA,IAAA,GAIZ,KAAA,WAAoB,IAGpB,KAAA,gBAAwB,IAGxB,KAAA,gBAA+B;AAAA,MAChC,EAAE,OAAO,OAAO,MAAM,KAAK,UAAU,KAAK,aAAa,KAAK,MAAA;AAAA,MAC5D,EAAE,OAAO,QAAQ,MAAM,KAAK,UAAU,KAAK,cAAc,KAAK,OAAA;AAAA,MAC/D,EAAE,OAAO,OAAO,MAAM,KAAK,UAAU,KAAK,aAAa,KAAK,MAAA;AAAA,IAAM,GAIhE,KAAA,eAA8B;AAAA,MAAC,EAAE,OAAO,WAAW,MAAM,KAAK,UAAU,KAAK,+BAA+B,KAAK,mBAAA;AAAA,MAC/G,EAAE,OAAO,cAAc,MAAM,KAAK,UAAU,KAAK,8BAA8B,KAAK,kBAAA;AAAA,MACpF,EAAE,OAAO,UAAU,MAAM,KAAK,UAAU,KAAK,2BAA2B,KAAK,eAAA;AAAA,IAAc,GAiB7FC,EAAA,MAAAO,GAAsB,CAACM,MAAa;AAClC,YAAMC,IAASD,EAAE;AACjB,MAAI,KAAK,kBACP,KAAK,eAAeC,EAAO,KAAe;AAAA,IAE9C,CAAA,GAEAd,EAAA,MAAAQ,GAAqB,CAACK,MAAa;AACjC,YAAMC,IAASD,EAAE;AACjB,MAAI,KAAK,iBACP,KAAK,cAAcC,EAAO,KAAe;AAAA,IAE7C,CAAA,GAEAd,EAAA,MAAAS,GAAsB,CAACM,MAAgC;AACrD,MAAI,KAAK,kBACP,KAAK,eAAeA,CAAM;AAAA,IAE9B,CAAA,GAEAf,EAAA,MAAAU,GAAoB,CAACM,GAAoC,MAAa;AACpE,YAAMC,IAAQ,EAAE;AAChB,MAAI,KAAK,gBACP,KAAK,aAAaD,GAAWC,EAAM,KAAK;AAAA,IAE5C,CAAA,GAEAjB,EAAA,MAAAW,GAAwB,CAACE,MAAa;AACpC,YAAMC,IAASD,EAAE;AACjB,MAAI,KAAK,oBACP,KAAK,iBAAiBC,EAAO,KAAK;AAAA,IAEtC,CAAA;AAAA,EAAA;AAAA,EAEA,SAAS;AACP,WAAOb;AAAA;AAAA,cAEG,KAAK,UAAU,KAAK,qBAAqB,KAAK,eAAe;AAAA,iCAC1C,KAAK,UAAU,KAAK,gCAAgC,KAAK,0BAA0B;AAAA;AAAA;AAAA;AAAA;AAAA,yCAK3E,KAAK,UAAU,KAAK,sBAAsB,KAAK,QAAQ;AAAA;AAAA;AAAA,wBAGxE,KAAK,cAAc,MAAM;AAAA,yBACxBC,QAAKK,CAAA,CAAmB;AAAA,2BACtB,KAAK,QAAQ;AAAA,0BACd,KAAK,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCAOJ,KAAK,UAAU,KAAK,qBAAqB,KAAK,OAAO;AAAA;AAAA;AAAA,wBAGrE,KAAK,cAAc,KAAK;AAAA,yBACvBL,QAAKM,CAAA,CAAkB;AAAA,2BACrB,KAAK,QAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAM5B,KAAK,cAAc,UAAU,WAAWP;AAAA;AAAA,uBAE7B,KAAK,UAAU,KAAK,yBAAyB,KAAK,YAAY;AAAA;AAAA;AAAA;AAAA,2BAI1D,KAAK,UAAU,KAAK,yBAAyB,KAAK,YAAY;AAAA,4BAC7D,KAAK,cAAc,aAAa,EAAE;AAAA,6BACjC,CAACY,MAAaX,EAAA,MAAKQ,CAAA,EAAL,KAAA,MAAuB,aAAaG,CAAA,CAAE;AAAA,+BAClD,KAAK,QAAQ;AAAA;AAAA;AAAA,+CAGG,KAAK,UAAU,KAAK,kBAAkB,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA,2BAInE,KAAK,UAAU,KAAK,uBAAuB,KAAK,UAAU;AAAA,4BACzD,KAAK,cAAc,WAAW,EAAE;AAAA,6BAC/B,CAACA,MAAaX,EAAA,MAAKQ,CAAA,EAAL,KAAA,MAAuB,WAAWG,CAAA,CAAE;AAAA,+BAChD,KAAK,QAAQ;AAAA;AAAA;AAAA;AAAA,cAI9B,EAAE;AAAA;AAAA;AAAA;AAAA,2CAI2B,KAAK,UAAU,KAAK,wBAAwB,KAAK,UAAU;AAAA;AAAA;AAAA,wBAG9E,KAAK,cAAc,QAAQ;AAAA,yBAC1BX,QAAKS,CAAA,CAAqB;AAAA,2BACxB,KAAK,QAAQ;AAAA;AAAA,wCAEA,KAAK,UAAU,KAAK,eAAe,KAAK,KAAK;AAAA,0CAC3C,KAAK,UAAU,KAAK,iBAAiB,KAAK,YAAY;AAAA,kDAC9C,KAAK,UAAU,KAAK,wBAAwB,KAAK,eAAe;AAAA,qDAC7D,KAAK,UAAU,KAAK,0BAA0B,KAAK,kBAAkB;AAAA,+CAC3E,KAAK,UAAU,KAAK,qBAAqB,KAAK,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAOzF,KAAK,UAAU,KAAK,8BAA8B,KAAK,iBAAiB;AAAA;AAAA;AAAA,uBAGjE,KAAK,UAAU,KAAK,kCAAkC,KAAK,qBAAqB;AAAA,0BAC7E,KAAK,cAAc,yBAAyB;AAAA,yBAC7C,MAAMT,EAAA,MAAKO,CAAA,EAAL,KAAA,MAAyB,2BAAA,CAA4B;AAAA,2BACzD,KAAK,QAAQ;AAAA;AAAA;AAAA;AAAA,uBAIjB,KAAK,UAAU,KAAK,8BAA8B,KAAK,iBAAiB;AAAA,0BACrE,KAAK,cAAc,qBAAqB;AAAA,yBACzC,MAAMP,EAAA,MAAKO,CAAA,EAAL,KAAA,MAAyB,uBAAA,CAAwB;AAAA,2BACrD,KAAK,QAAQ;AAAA;AAAA;AAAA;AAAA,uBAIjB,KAAK,UAAU,KAAK,8BAA8B,KAAK,iBAAiB;AAAA,0BACrE,KAAK,cAAc,qBAAqB;AAAA,yBACzC,MAAMP,EAAA,MAAKO,CAAA,EAAL,KAAA,MAAyB,uBAAA,CAAwB;AAAA,2BACrD,KAAK,QAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAQ5B,KAAK,UAAU,KAAK,0BAA0B,KAAK,qBAAqB,aAAa,KAAK,aAAa;AAAA;AAAA;AAAA;AAAA,EAIjH;AAGF;AAnJEF,IAAA,oBAAA,QAAA;AAOAC,IAAA,oBAAA,QAAA;AAOAC,IAAA,oBAAA,QAAA;AAMAC,IAAA,oBAAA,QAAA;AAOAC,IAAA,oBAAA,QAAA;AAvEWC,EA8LJ,SAAST,IAAMe,EAAUC,EAAM,CAAC;AA5LvCf,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,OAAA,CAAQ;AAAA,GADfO,EAEX,WAAA,iBAAA,CAAA;AAUAR,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,QAAA,CAAS;AAAA,GAXhBO,EAYX,WAAA,YAAA,CAAA;AAGAR,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,OAAA,CAAQ;AAAA,GAdfO,EAeX,WAAA,iBAAA,CAAA;AAeAR,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,SAAA,CAAU;AAAA,GA7BjBO,EA8BX,WAAA,kBAAA,CAAA;AAGAR,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,SAAA,CAAU;AAAA,GAhCjBO,EAiCX,WAAA,iBAAA,CAAA;AAGAR,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,SAAA,CAAU;AAAA,GAnCjBO,EAoCX,WAAA,kBAAA,CAAA;AAGAR,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,SAAA,CAAU;AAAA,GAtCjBO,EAuCX,WAAA,gBAAA,CAAA;AAGAR,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,SAAA,CAAU;AAAA,GAzCjBO,EA0CX,WAAA,oBAAA,CAAA;AA1CWA,IAANR,EAAA;AAAA,EADNE,EAAc,2BAA2B;AAAA,GAC7BM,CAAA;;;;;;;ACDN,IAAMQ,IAAN,cAAoCtB,EAAgBC,CAAU,EAAE;AAAA,EAAhE,cAAA;AAAA,UAAA,GAAA,SAAA,GAEL,KAAA,cAAuB,IAGvB,KAAA,WAAmB;AAAA,EAAA;AAAA,EAEnB,SAAS;AACP,WAAK,KAAK,cAIHE;AAAA;AAAA;AAAA,qDAG0C,KAAK,QAAQ;AAAA;AAAA;AAAA,YAGtD,KAAK,UAAU,KAAK,kBAAkB,KAAK,cAAc,IAAI,KAAK,QAAQ;AAAA;AAAA;AAAA,QATzEA;AAAA,EAaX;AAGF;AAzBamB,EAwBJ,SAASjB,IAAMe,EAAUC,EAAM,CAAC;AAtBvCf,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,QAAA,CAAS;AAAA,GADhBe,EAEX,WAAA,eAAA,CAAA;AAGAhB,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,OAAA,CAAQ;AAAA,GAJfe,EAKX,WAAA,YAAA,CAAA;AALWA,IAANhB,EAAA;AAAA,EADNE,EAAc,4BAA4B;AAAA,GAC9Bc,CAAA;;;;;;;wYCZbC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC;AAsBO,IAAMC,IAAN,cAA2C9B,EAAgB+B,CAAe,EAAE;AAAA,EAyBjF,cAAc;AACZ,UAAA,GA1BG7B,EAAA,MAAAuB,CAAA,GAIL,KAAQ,eAAwB,IAGhC,KAAQ,kBAA0B,GAGlC,KAAQ,iBAAgC;AAAA,MACtC,QAAQ;AAAA,MACR,OAAO;AAAA,MACP,2BAA2B;AAAA,MAC3B,uBAAuB;AAAA,MACvB,uBAAuB;AAAA,MACvB,UAAU;AAAA,IAAA,GAIZ,KAAQ,iBAAyB,IAEjCvB,EAAA,MAAAqB,CAAA,GACArB,EAAA,MAAAsB,CAAA,GA6BAtB,EAAA,MAAAyB,GAAgB,YAAY;AAC1B,UAAI,GAACvB,EAAA,MAAKmB,CAAA,KAAkB,KAAK,eAIjC;AAAA,aAAK,eAAe,IACpB,KAAK,kBAAkB;AAEvB,YAAI;AAEF,cAAI,KAAK,eAAe,UAAU,UAAU;AAC1C,gBAAI,CAAC,KAAK,eAAe,aAAa,CAAC,KAAK,eAAe;AACzD,oBAAM,IAAI,MAAM,KAAK,UAAU,KAAK,8BAA8B,KAAK,wDAAwD;AAGjI,kBAAM7B,IAAQ,IAAI,KAAK,KAAK,eAAe,SAAS,GAC9CC,IAAM,IAAI,KAAK,KAAK,eAAe,OAAO;AAEhD,gBAAID,IAAQC;AACV,oBAAM,IAAI,MAAM,KAAK,UAAU,KAAK,mCAAmC,KAAK,oCAAoC;AAAA,UAEpH;AAEA,eAAK,kBAAkB,IAEvB,MAAMS,EAAA,MAAKmB,CAAA,EAAe,cAAc,KAAK,cAAc,GAE3D,KAAK,kBAAkB,KAEnBnB,QAAKoB,CAAA,KACPpB,EAAA,MAAKoB,CAAA,EAAqB,KAAK,YAAY;AAAA,YACzC,MAAM;AAAA,cACJ,UAAU,KAAK,UAAU,KAAK,uBAAuB,KAAK;AAAA,cAC1D,SAAS,GAAG,KAAK,UAAU,KAAK,oCAAoC,KAAK,+BAA+B,KAAK,KAAK,cAAc;AAAA,YAAA;AAAA,UAClI,CACD,GAIH,WAAW,MAAM;AACf,YAAI,KAAK,gBACP,KAAK,aAAa,OAAA;AAAA,UAEtB,GAAG,GAAI;AAAA,QAET,SAASzC,GAAO;AACd,kBAAQ,MAAM,iBAAiBA,CAAK,GAEhCqB,QAAKoB,CAAA,KACPpB,EAAA,MAAKoB,CAAA,EAAqB,KAAK,UAAU;AAAA,YACvC,MAAM;AAAA,cACJ,UAAU,KAAK,UAAU,KAAK,qBAAqB,KAAK;AAAA,cACxD,SAASzC,aAAiB,QACtBA,EAAM,UACN,KAAK,UAAU,KAAK,8BAA8B,KAAK;AAAA,YAAA;AAAA,UAC7D,CACD,GAGH,KAAK,eAAe,IACpB,KAAK,kBAAkB;AAAA,QACzB;AAAA;AAAA,IACF,CAAA,GAEAmB,EAAA,MAAA0B,GAAqB,OAAO5C,MAAmB;AAC7C,UAAI,GAACoB,EAAA,MAAKmB,CAAA,KAAkB,KAAK,eAIjC;AAAA,aAAK,eAAe;AAEpB,YAAI;AACF,gBAAMnB,EAAA,MAAKmB,CAAA,EAAe,YAAY,IAAM,IAAMvC,CAAM,GAEpDoB,QAAKoB,CAAA,KACPpB,EAAA,MAAKoB,CAAA,EAAqB,KAAK,YAAY;AAAA,YACzC,MAAM;AAAA,cACJ,UAAU,KAAK,UAAU,KAAK,uBAAuB,KAAK;AAAA,cAC1D,SAAS,GAAG,KAAK,UAAU,KAAK,6BAA6B,KAAK,iBAAiB,IAAIxC,EAAO,YAAA,CAAa,IAAI,KAAK,UAAU,KAAK,kBAAkB,KAAK,WAAW;AAAA,YAAA;AAAA,UACvK,CACD,GAIC,KAAK,gBACP,KAAK,aAAa,OAAA;AAAA,QAGtB,SAASD,GAAO;AACd,kBAAQ,MAAM,uBAAuBA,CAAK,GAEtCqB,QAAKoB,CAAA,KACPpB,EAAA,MAAKoB,CAAA,EAAqB,KAAK,UAAU;AAAA,YACvC,MAAM;AAAA,cACJ,UAAU,KAAK,UAAU,KAAK,qBAAqB,KAAK;AAAA,cACxD,SAASzC,aAAiB,QACtBA,EAAM,UACN,KAAK,UAAU,KAAK,8BAA8B,KAAK;AAAA,YAAA;AAAA,UAC7D,CACD;AAAA,QAEL,UAAA;AACE,eAAK,eAAe;AAAA,QACtB;AAAA;AAAA,IACF,CAAA,GAEAmB,EAAA,MAAA2B,GAAgB,MAAM;AACpB,MAAI,KAAK,gBACP,KAAK,aAAa,OAAA;AAAA,IAEtB,CAAA,GAtIE,KAAK,eAAeG,GAA0B,CAACC,MAAwB;AACrE,MAAAC,EAAA,MAAKV,GAAuBS,CAAA;AAAA,IAC9B,CAAC,GAED,KAAK,eAAeE,GAAkB,CAACC,MAAgB;AACrD,MAAAF,EAAA,MAAKX,GAAiB,IAAI7C,GAAqB,YAAY;AACzD,cAAMG,IAAQ,MAAMuD,GAAa,eAAA;AACjC,YAAI,CAACvD;AACH,gBAAM,IAAI,MAAM,mCAAmC;AAErD,eAAOA;AAAA,MACT,CAAC,CAAA;AAAA,IACH,CAAC,GAGDwD,EAAA,MAAKZ,GAAAC,CAAA,EAAL,KAAA,IAAA;AAAA,EACF;AAAA,EAwHA,SAAS;AACP,WAAOvB;AAAA;AAAA,qCAE0B,KAAK,UAAU,KAAK,cAAc,KAAK,gBAAgB;AAAA;AAAA;AAAA,2BAGjE,KAAK,YAAY;AAAA,8BACd,MAAMC,EAAA,MAAKwB,CAAA,EAAL,KAAA,MAAwB,KAAA,CAAM;AAAA,+BACnC,MAAMxB,EAAA,MAAKwB,CAAA,EAAL,KAAA,MAAwB,KAAA,CAAM;AAAA;AAAA;AAAA;AAAA,sBAI7C,KAAK,UAAU,KAAK,WAAW,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA,gCAI9B,KAAK,cAAc;AAAA,2BACxB,KAAK,YAAY;AAAA,gCACZ,KAAK,cAAc;AAAA,iCAClB,CAAC5C,MAAmB;AACrC,WAAK,iBAAiB,EAAE,GAAG,KAAK,gBAAgB,QAAAA,EAAA,GAChDqD,EAAA,MAAKZ,GAAAC,CAAA,EAAL,KAAA,IAAA;AAAA,IACF,CAAC;AAAA,gCACiB,CAACY,MAAkB;AACnC,WAAK,iBAAiB,EAAE,GAAG,KAAK,gBAAgB,OAAAA,EAAA;AAAA,IAClD,CAAC;AAAA,iCACkB,CAACrB,MAAgC;AAClD,WAAK,iBAAiB;AAAA,QACpB,GAAG,KAAK;AAAA,QACR,CAACA,CAAM,GAAG,CAAC,KAAK,eAAeA,CAAM;AAAA,MAAA,GAEvCoB,EAAA,MAAKZ,GAAAC,CAAA,EAAL,KAAA,IAAA;AAAA,IACF,CAAC;AAAA,+BACgB,CAACR,GAAoCqB,MAAkB;AACtE,WAAK,iBAAiB;AAAA,QACpB,GAAG,KAAK;AAAA,QACR,CAACrB,CAAS,GAAGqB,KAAS;AAAA,MAAA;AAAA,IAE1B,CAAC;AAAA,mCACoB,CAACC,MAAqB;AACzC,WAAK,iBAAiB,EAAE,GAAG,KAAK,gBAAgB,UAAAA,EAAA;AAAA,IAClD,CAAC;AAAA;AAAA;AAAA;AAAA,8BAIe,KAAK,YAAY;AAAA,2BACpB,KAAK,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAOvBpC,QAAKyB,CAAA,CAAa;AAAA,2BACf,KAAK,YAAY;AAAA;AAAA,gBAE5B,KAAK,UAAU,KAAK,eAAe,KAAK,QAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAMxCzB,QAAKuB,CAAA,CAAa;AAAA,2BACf,KAAK,gBAAiB,CAAC,KAAK,eAAe,6BAA6B,CAAC,KAAK,eAAe,qBAAsB;AAAA;AAAA,gBAE9H,KAAK,eAAexB;AAAA;AAAA,kBAElB,KAAK,UAAU,KAAK,kBAAkB,KAAK,cAAc;AAAA,kBACzDA;AAAA;AAAA,kBAEA,KAAK,UAAU,KAAK,sBAAsB,KAAK,gBAAgB;AAAA,eAClE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMb;AAGF;AA9NEoB,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AAvBKC,IAAA,oBAAA,QAAA;AA8CLC,IAAoB,WAAG;AACrB,EAAItB,QAAKmB,CAAA,MACP,KAAK,iBAAiBnB,EAAA,MAAKmB,CAAA,EAAe,iBAAiB,KAAK,cAAc;AAElF;AAEAI,IAAA,oBAAA,QAAA;AAgEAC,IAAA,oBAAA,QAAA;AA0CAC,IAAA,oBAAA,QAAA;AA9JWC,EAmPJ,SAAS,CAAC,GAAGW,EAAgB,QAAQpC,IAAMe,EAAUsB,EAAY,CAAC,EAAE;AA/OnEpC,EAAA;AAAA,EADPqC,EAAA;AAAM,GAHIb,EAIH,WAAA,gBAAA,CAAA;AAGAxB,EAAA;AAAA,EADPqC,EAAA;AAAM,GANIb,EAOH,WAAA,mBAAA,CAAA;AAGAxB,EAAA;AAAA,EADPqC,EAAA;AAAM,GATIb,EAUH,WAAA,kBAAA,CAAA;AAUAxB,EAAA;AAAA,EADPqC,EAAA;AAAM,GAnBIb,EAoBH,WAAA,kBAAA,CAAA;AApBGA,IAANxB,EAAA;AAAA,EADNE,EAAc,yBAAyB;AAAA,GAC3BsB,CAAA;AAsPb,MAAAc,KAAed;"}